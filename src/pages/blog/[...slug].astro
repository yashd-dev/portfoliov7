---
import { getEntry } from "astro:content";
import Layout from "../layout.astro";
import slugify from "slugify";

const { slug } = Astro.params;
if (slug === undefined) {
	throw new Error("Slug is required");
}

const entry = await getEntry("posts", slug);
if (entry === undefined) {
	return Astro.redirect("/blog");
}
const { Content } = await entry.render();
if (!entry.data.draft) {
	return Astro.redirect("/blog");
}
---

<Layout
	title={entry.data.title}
	imgurl=`https://yashd.tech/og/${slugify(entry.data.title, {
			lower: true,
			trim: true,
			remove: undefined,
		})}.png`
	description="Blog page of Yash Deshpande :)"
>
	<article
		class="article w-full flex flex-col justify-center mx-auto pt-[10vh]"
	>
		{
			entry.data.image.url == "" ? (
				<img src={entry.data.image.url} class="mx-auto" />
			) : (
				""
			)
		}<h1 class="!font-bold !text-title !text-center">
			{entry.data.title}
		</h1>
		<h4
			class="flex flex-col md:flex-row gap-x-10 gap-y-2 mx-auto items-center justify-center mt-8"
		>
			<span class="flex gap-2 items-center"
				><img
					class="w-8 aspect-square !rounded-full"
					src="/images/white.jpg"
					alt="Avatar for Yash D"
				/>Yash Deshpande
			</span>
			<span
				>Written on {
					new Date(entry.data.pubDate).toLocaleDateString("en-US", {
						month: "long",
						day: "numeric",
						year: "numeric",
					})
				}
			</span>
		</h4>

		<span
			class="flex flex-row items-center justify-center gap-5 *:border *:px-2.5 *:py-1 *:rounded-2xl"
		>
			{
				entry.data.tags.map((tag: string) => (
					<span class=" transition hover:bg-green hover:text-background">
						{tag}
					</span>
				))
			}
		</span>
		<Content />
	</article>
</Layout>
